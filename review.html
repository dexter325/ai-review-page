<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå›¾ç‰‡å®¡æ ¸ç³»ç»Ÿ - è¿æ¥è¯Šæ–­</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: white;
            border-bottom: 3px solid #3498db;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .diagnostic-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .diagnostic-section h3 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }
        
        .test-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .result-box {
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 14px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .success {
            color: #27ae60;
            border-left: 4px solid #27ae60;
        }
        
        .error {
            color: #e74c3c;
            border-left: 4px solid #e74c3c;
        }
        
        .warning {
            color: #f39c12;
            border-left: 4px solid #f39c12;
        }
        
        .info {
            color: #3498db;
            border-left: 4px solid #3498db;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-secondary {
            background: #95a5a6;
            color: white;
        }
        
        .btn-success {
            background: #2ecc71;
            color: white;
        }
        
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        
        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-online {
            background: #2ecc71;
        }
        
        .status-offline {
            background: #e74c3c;
        }
        
        .status-unknown {
            background: #f39c12;
        }
        
        .url-test {
            margin: 10px 0;
            padding: 10px;
            background: #eee;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ–¼ï¸ AIå›¾ç‰‡å®¡æ ¸ç³»ç»Ÿ - è¿æ¥è¯Šæ–­</h1>
            <p>æ£€æµ‹å¹¶è§£å†³æäº¤å¤±è´¥çš„é—®é¢˜</p>
        </div>
        
        <div class="tabs">
            <div class="tab active" onclick="switchTab('diagnostic')">è¿æ¥è¯Šæ–­</div>
            <div class="tab" onclick="switchTab('review')">å›¾ç‰‡å®¡æ ¸</div>
            <div class="tab" onclick="switchTab('settings')">è®¾ç½®</div>
        </div>
        
        <div id="diagnostic" class="tab-content active">
            <div class="diagnostic-section">
                <h3>ç½‘ç»œè¿æ¥æµ‹è¯•</h3>
                <p>æµ‹è¯•ä¸ngrokæœåŠ¡å™¨çš„è¿æ¥çŠ¶æ€</p>
                <button class="test-button" onclick="testConnection()">æµ‹è¯•è¿æ¥</button>
                <div id="connection-result" class="result-box">ç­‰å¾…æµ‹è¯•ç»“æœ...</div>
            </div>
            
            <div class="diagnostic-section">
                <h3>Webhookç«¯ç‚¹æµ‹è¯•</h3>
                <p>æµ‹è¯•å®¡æ ¸é€šè¿‡å’Œè¦æ±‚ä¿®æ”¹çš„Webhookç«¯ç‚¹</p>
                
                <div class="url-test">
                    <strong>å®¡æ ¸é€šè¿‡URL:</strong> 
                    <span id="approve-url">https://clonally-hastier-sharmaine.ngrok-free.dev/webhook/8208c765-fa63-49ec-9c77-642ab9050333</span>
                </div>
                
                <div class="url-test">
                    <strong>è¦æ±‚ä¿®æ”¹URL:</strong> 
                    <span id="reject-url">https://clonally-hastier-sharmaine.ngrok-free.dev/webhook/e9d9ff48-0821-4ad7-b3c9-4ce92583ecfe</span>
                </div>
                
                <button class="test-button" onclick="testWebhook('approve')">æµ‹è¯•å®¡æ ¸é€šè¿‡ç«¯ç‚¹</button>
                <button class="test-button" onclick="testWebhook('reject')">æµ‹è¯•è¦æ±‚ä¿®æ”¹ç«¯ç‚¹</button>
                
                <div id="webhook-result" class="result-box">ç­‰å¾…æµ‹è¯•ç»“æœ...</div>
            </div>
            
            <div class="diagnostic-section">
                <h3>æ•…éšœæ’é™¤å»ºè®®</h3>
                <div id="troubleshooting">
                    <p>1. ç¡®ä¿ngrokæ­£åœ¨è¿è¡Œå¹¶ä¸”ä¼šè¯çŠ¶æ€ä¸ºonline</p>
                    <p>2. æ£€æŸ¥Webhook URLæ˜¯å¦æ­£ç¡®æ— è¯¯</p>
                    <p>3. éªŒè¯n8nä¸­çš„WebhookèŠ‚ç‚¹é…ç½®æ˜¯å¦æ­£ç¡®</p>
                    <p>4. æ£€æŸ¥é˜²ç«å¢™æˆ–ç½‘ç»œè®¾ç½®æ˜¯å¦é˜»æ­¢äº†è¯·æ±‚</p>
                    <p>5. å°è¯•é‡æ–°å¯åŠ¨ngrokä¼šè¯è·å–æ–°çš„URL</p>
                </div>
            </div>
        </div>
        
        <div id="review" class="tab-content">
            <div class="diagnostic-section">
                <h3>å›¾ç‰‡å®¡æ ¸åŠŸèƒ½</h3>
                <p>æ­¤åŠŸèƒ½éœ€è¦å…ˆè§£å†³è¿æ¥é—®é¢˜</p>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="switchTab('diagnostic')">å…ˆè¿›è¡Œè¿æ¥è¯Šæ–­</button>
                </div>
            </div>
        </div>
        
        <div id="settings" class="tab-content">
            <div class="diagnostic-section">
                <h3>é…ç½®è®¾ç½®</h3>
                <p>æ›´æ–°Webhook URLåœ°å€</p>
                
                <div style="margin: 15px 0;">
                    <label for="approve-url-input">å®¡æ ¸é€šè¿‡URL:</label>
                    <input type="text" id="approve-url-input" style="width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 4px;" 
                           value="https://clonally-hastier-sharmaine.ngrok-free.dev/webhook/8208c765-fa63-49ec-9c77-642ab9050333">
                </div>
                
                <div style="margin: 15px 0;">
                    <label for="reject-url-input">è¦æ±‚ä¿®æ”¹URL:</label>
                    <input type="text" id="reject-url-input" style="width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 4px;" 
                           value="https://clonally-hastier-sharmaine.ngrok-free.dev/webhook/e9d9ff48-0821-4ad7-b3c9-4ce92583ecfe">
                </div>
                
                <button class="btn btn-success" onclick="saveSettings()">ä¿å­˜è®¾ç½®</button>
                <button class="btn btn-secondary" onclick="resetSettings()">é‡ç½®ä¸ºé»˜è®¤</button>
            </div>
        </div>
    </div>

    <script>
        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tabId) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`.tab:nth-child(${tabId === 'diagnostic' ? 1 : tabId === 'review' ? 2 : 3})`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }
        
        // æµ‹è¯•è¿æ¥
        async function testConnection() {
            const resultBox = document.getElementById('connection-result');
            resultBox.className = 'result-box info';
            resultBox.innerHTML = 'æ­£åœ¨æµ‹è¯•è¿æ¥...';
            
            try {
                // æµ‹è¯•åŸºæœ¬ç½‘ç»œè¿æ¥
                const response = await fetch('https://clonally-hastier-sharmaine.ngrok-free.dev', {
                    method: 'HEAD',
                    headers: {
                        'ngrok-skip-browser-warning': 'true'
                    }
                });
                
                if (response.status < 400) {
                    resultBox.className = 'result-box success';
                    resultBox.innerHTML = 'âœ… è¿æ¥æˆåŠŸï¼ngrokæœåŠ¡å™¨å¯ä»¥è®¿é—®ã€‚';
                } else {
                    resultBox.className = 'result-box error';
                    resultBox.innerHTML = 'âŒ è¿æ¥å¤±è´¥ã€‚æœåŠ¡å™¨è¿”å›çŠ¶æ€: ' + response.status;
                }
            } catch (error) {
                resultBox.className = 'result-box error';
                resultBox.innerHTML = 'âŒ è¿æ¥å¤±è´¥: ' + error.message;
            }
        }
        
        // æµ‹è¯•Webhookç«¯ç‚¹
        async function testWebhook(type) {
            const resultBox = document.getElementById('webhook-result');
            resultBox.className = 'result-box info';
            resultBox.innerHTML = `æ­£åœ¨æµ‹è¯•${type === 'approve' ? 'å®¡æ ¸é€šè¿‡' : 'è¦æ±‚ä¿®æ”¹'}ç«¯ç‚¹...`;
            
            const url = type === 'approve' ? 
                document.getElementById('approve-url-input').value : 
                document.getElementById('reject-url-input').value;
            
            try {
                const testData = {
                    test: true,
                    timestamp: new Date().toISOString(),
                    type: type
                };
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'ngrok-skip-browser-warning': 'true'
                    },
                    body: JSON.stringify(testData)
                });
                
                if (response.status < 400) {
                    resultBox.className = 'result-box success';
                    resultBox.innerHTML = `âœ… ${type === 'approve' ? 'å®¡æ ¸é€šè¿‡' : 'è¦æ±‚ä¿®æ”¹'}ç«¯ç‚¹æµ‹è¯•æˆåŠŸï¼`;
                } else {
                    resultBox.className = 'result-box error';
                    resultBox.innerHTML = `âŒ ç«¯ç‚¹æµ‹è¯•å¤±è´¥ã€‚æœåŠ¡å™¨è¿”å›çŠ¶æ€: ${response.status}`;
                }
            } catch (error) {
                resultBox.className = 'result-box error';
                resultBox.innerHTML = `âŒ ç«¯ç‚¹æµ‹è¯•å¤±è´¥: ${error.message}`;
            }
        }
        
        // ä¿å­˜è®¾ç½®
        function saveSettings() {
            const approveUrl = document.getElementById('approve-url-input').value;
            const rejectUrl = document.getElementById('reject-url-input').value;
            
            localStorage.setItem('approveWebhookUrl', approveUrl);
            localStorage.setItem('rejectWebhookUrl', rejectUrl);
            
            alert('è®¾ç½®å·²ä¿å­˜ï¼');
        }
        
        // é‡ç½®è®¾ç½®
        function resetSettings() {
            document.getElementById('approve-url-input').value = 
                'https://clonally-hastier-sharmaine.ngrok-free.dev/webhook/8208c765-fa63-49ec-9c77-642ab9050333';
            document.getElementById('reject-url-input').value = 
                'https://clonally-hastier-sharmaine.ngrok-free.dev/webhook/e9d9ff48-0821-4ad7-b3c9-4ce92583ecfe';
            
            localStorage.removeItem('approveWebhookUrl');
            localStorage.removeItem('rejectWebhookUrl');
            
            alert('è®¾ç½®å·²é‡ç½®ä¸ºé»˜è®¤å€¼ï¼');
        }
        
        // åŠ è½½ä¿å­˜çš„è®¾ç½®
        function loadSettings() {
            const approveUrl = localStorage.getItem('approveWebhookUrl');
            const rejectUrl = localStorage.getItem('rejectWebhookUrl');
            
            if (approveUrl) {
                document.getElementById('approve-url-input').value = approveUrl;
                document.getElementById('approve-url').textContent = approveUrl;
            }
            
            if (rejectUrl) {
                document.getElementById('reject-url-input').value = rejectUrl;
                document.getElementById('reject-url').textContent = rejectUrl;
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
        });
    </script>
</body>
</html>

